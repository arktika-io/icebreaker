#!/usr/bin/env bash

PROJECT="$(dirname "$(dirname "$(realpath "${0}")")")"
ENV_DIR="${PROJECT}/.env"
PYTHON_ENV_DIR="${ENV_DIR}/python"

cd "${PROJECT}" || return 1

if [ ! -d "${PYTHON_ENV_DIR}" ]; then
    "${PROJECT}/bin/setup"
fi

if [[ "${OSTYPE}" == "msys" || "${OSTYPE}" == "win32" ]]; then
    source "${PYTHON_ENV_DIR}/Scripts/activate"
else
    source "${PYTHON_ENV_DIR}/bin/activate"
fi

if [[ ${0} == "${BASH_SOURCE}" ]]; then
    # Execute passed command, if we're not being sourced.
    "$@"
fi
